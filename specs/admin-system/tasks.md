# 实施计划 - 日新智课管理员端

## 任务分组

### 阶段 1：环境准备与基础配置（2小时）

- [x] 1.1 安装 Element Plus 依赖
  - 执行 `pnpm add element-plus @element-plus/icons-vue`
  - _需求: 所有页面需要使用 Element Plus 组件_

- [ ] 1.2 配置云开发环境ID
  - 创建 `.env` 文件
  - 配置 `VITE_ENV_ID=cloud1-1gt445eta224436c`
  - 更新 `src/utils/cloudbase.js`
  - _需求: 所有云函数调用需要环境ID_

- [ ] 1.3 配置 Element Plus 主题（BJUT 蓝）
  - 在 `src/main.js` 中引入 Element Plus
  - 创建 `src/style.css` 覆盖主题色为 #0096C2
  - _需求: 需求1 - 使用 BJUT 官方配色_

- [ ] 1.4 创建 API 封装工具
  - 创建 `src/utils/api.js`
  - 封装云函数调用方法
  - _需求: 所有页面需要调用云函数_

- [ ] 1.5 创建格式化工具
  - 创建 `src/utils/format.js`
  - 实现时间格式化、状态格式化
  - _需求: 需求2 - 显示时间和状态_

---

### 阶段 2：登录页开发（1小时）

- [ ] 2.1 创建登录页组件
  - 创建 `src/pages/LoginPage.vue`
  - 左侧校园轮播图，右侧登录卡片
  - _需求: 辅助功能4 - 登录页_

- [ ] 2.2 实现匿名登录
  - 调用 `ensureLogin()` 方法
  - 登录成功后跳转到 `/dashboard`
  - _需求: 辅助功能4 - CloudBase 匿名登录_

- [ ] 2.3 添加 BJUT 视觉元素
  - 使用 `school-logo-with-name-horizontal-1218x378.png`
  - 使用 `carousel/` 下的轮播图
  - _需求: 辅助功能4 - BJUT 视觉元素_

- [ ] 2.4 配置登录路由
  - 在 `src/main.js` 中添加 `/login` 路由
  - _需求: 辅助功能4 - 登录页路由_

---

### 阶段 3：主布局开发（2小时）

- [ ] 3.1 创建主布局组件
  - 创建 `src/components/Layout.vue`
  - 左侧菜单 + 顶部导航 + 主内容区
  - _需求: 辅助功能6 - 系统布局_

- [ ] 3.2 实现左侧菜单
  - 使用 `el-menu` 组件
  - 菜单项：数据看板、申请审核、排课管理、排课结果
  - 可折叠/展开
  - 使用 BJUT 校徽作为 Logo
  - _需求: 辅助功能6 - 左侧菜单_

- [ ] 3.3 实现顶部导航
  - 用户信息展示（"管理员"）
  - 退出按钮（调用 `logout()`）
  - _需求: 辅助功能6 - 顶部导航_

- [ ] 3.4 配置布局路由
  - 父路由指向 `Layout` 组件
  - 子路由嵌套其他页面
  - _需求: 辅助功能6 - 路由嵌套_

- [ ] 3.5 实现路由守卫
  - 检查登录状态
  - 未登录跳转到 `/login`
  - _需求: 辅助功能6 - 路由守卫_

---

### 阶段 4：数据看板开发（2小时）

- [ ] 4.1 创建数据看板页面
  - 创建 `src/pages/DashboardPage.vue`
  - _需求: 功能1 - 数据看板_

- [ ] 4.2 创建统计卡片组件
  - 创建 `src/components/StatCard.vue`
  - 显示图标、数字、标题
  - 可点击跳转
  - _需求: 功能1 - 统计卡片_

- [ ] 4.3 开发云函数 getStatistics
  - 创建 `cloudfunctions/getStatistics/index.js`
  - 查询待审核、总数、已排课、冲突数量
  - _需求: 功能1 - 统计数据查询_

- [ ] 4.4 集成统计数据
  - 调用 `getStatistics` 云函数
  - 渲染4个统计卡片
  - _需求: 功能1 - 显示统计卡片_

- [ ] 4.5 实现卡片点击跳转
  - 待审核 → `/review`
  - 已排课 → `/result`
  - _需求: 功能1 - 卡片跳转_

---

### 阶段 5：申请审核开发（4小时）

- [ ] 5.1 创建申请审核页面
  - 创建 `src/pages/ReviewPage.vue`
  - _需求: 功能2 - 申请审核_

- [ ] 5.2 开发云函数 getBookingList
  - 创建 `cloudfunctions/getBookingList/index.js`
  - 支持状态筛选
  - 按提交时间倒序
  - _需求: 功能2 - 查询申请列表_

- [ ] 5.3 实现申请列表表格
  - 使用 `el-table` 组件
  - 列：申请编号、教师姓名、课程名称、学生人数、申请时间、状态、操作
  - _需求: 功能2 - 显示申请列表_

- [ ] 5.4 实现状态筛选
  - 使用 `el-select` 组件
  - 选项：全部、待审核、已通过、已拒绝
  - _需求: 功能2 - 状态筛选_

- [ ] 5.5 实现查看详情对话框
  - 使用 `el-dialog` 组件
  - 显示完整申请信息
  - 包含时间段表格
  - _需求: 功能2 - 查看详情_

- [ ] 5.6 开发云函数 reviewBooking
  - 创建 `cloudfunctions/reviewBooking/index.js`
  - 支持通过/拒绝操作
  - 记录审核时间和理由
  - _需求: 功能2 - 审核申请_

- [ ] 5.7 实现审核通过功能
  - 点击"通过"按钮
  - 弹出确认对话框
  - 调用 `reviewBooking` 云函数
  - _需求: 功能2 - 审核通过_

- [ ] 5.8 实现审核拒绝功能
  - 点击"拒绝"按钮
  - 弹出输入框要求填写理由
  - 调用 `reviewBooking` 云函数
  - _需求: 功能2 - 审核拒绝_

- [ ] 5.9 实现列表刷新
  - 审核成功后自动刷新列表
  - 显示成功/失败提示
  - _需求: 功能2 - 操作反馈_

---

### 阶段 6：排课管理开发（5小时）

- [ ] 6.1 创建排课管理页面
  - 创建 `src/pages/SchedulePage.vue`
  - _需求: 功能3 - 自动排课_

- [ ] 6.2 实现未排课申请列表
  - 使用 `el-table` 组件
  - 筛选条件：`status = 1 AND is_scheduled = 0`
  - _需求: 功能3 - 显示未排课申请_

- [ ] 6.3 开发云函数 autoSchedule
  - 创建 `cloudfunctions/autoSchedule/index.js`
  - 实现容量匹配逻辑
  - 实现时间冲突检测
  - 创建排课记录
  - _需求: 功能3 - 自动排课算法_

- [ ] 6.4 实现单个自动排课
  - 点击"自动排课"按钮
  - 调用 `autoSchedule` 云函数
  - 显示成功/失败提示
  - _需求: 功能3 - 单个排课_

- [ ] 6.5 实现批量自动排课
  - 点击"批量自动排课"按钮
  - 依次处理所有申请
  - 显示结果统计
  - _需求: 功能3 - 批量排课_

- [ ] 6.6 处理排课成功
  - 显示分配的实验室信息
  - 从列表中移除
  - _需求: 功能3 - 排课成功处理_

- [ ] 6.7 处理排课失败
  - 显示冲突原因
  - 保留在列表中
  - _需求: 功能3 - 排课失败处理_

---

### 阶段 7：排课结果开发（2小时）

- [ ] 7.1 创建排课结果页面
  - 创建 `src/pages/ResultPage.vue`
  - _需求: 辅助功能5 - 排课结果_

- [ ] 7.2 开发云函数 getScheduleList
  - 创建 `cloudfunctions/getScheduleList/index.js`
  - 支持学年学期筛选
  - _需求: 辅助功能5 - 查询排课结果_

- [ ] 7.3 实现排课结果表格
  - 使用 `el-table` 组件
  - 列：课程名称、教师姓名、实验室、时间段、排课时间
  - _需求: 辅助功能5 - 显示排课结果_

- [ ] 7.4 实现学期筛选
  - 使用 `el-select` 组件
  - 选项：学年学期
  - _需求: 辅助功能5 - 学期筛选_

---

### 阶段 8：云函数部署（1小时）

- [ ] 8.1 部署 getStatistics
  - 右键 → 上传并部署：云端安装依赖
  - _需求: 所有云函数需要部署_

- [ ] 8.2 部署 getBookingList
  - 右键 → 上传并部署：云端安装依赖
  - _需求: 所有云函数需要部署_

- [ ] 8.3 部署 reviewBooking
  - 右键 → 上传并部署：云端安装依赖
  - _需求: 所有云函数需要部署_

- [ ] 8.4 部署 autoSchedule
  - 右键 → 上传并部署：云端安装依赖
  - _需求: 所有云函数需要部署_

- [ ] 8.5 部署 getScheduleList
  - 右键 → 上传并部署：云端安装依赖
  - _需求: 所有云函数需要部署_

---

### 阶段 9：前端部署（0.5小时）

- [ ] 9.1 构建生产版本
  - 执行 `pnpm build`
  - 检查 `dist` 目录
  - _需求: 前端需要部署到静态托管_

- [ ] 9.2 部署到静态托管
  - 上传 `dist` 目录到云开发静态托管
  - 获取访问链接
  - _需求: 前端需要部署到静态托管_

---

### 阶段 10：测试与文档（1.5小时）

- [ ] 10.1 功能测试
  - 测试登录流程
  - 测试申请审核流程
  - 测试自动排课流程
  - 测试数据展示
  - _需求: 所有功能需要测试_

- [ ] 10.2 修复 Bug
  - 记录测试中发现的问题
  - 逐一修复
  - _需求: 所有功能需要测试_

- [ ] 10.3 更新 README
  - 添加项目说明
  - 添加部署步骤
  - 添加使用说明
  - _需求: 项目需要文档_

- [ ] 10.4 生成 cloudbaserc.json
  - 记录云开发资源
  - 方便后续维护
  - _需求: 项目需要配置文件_

---

## 时间估算

| 阶段 | 预估时间 | 累计时间 |
|------|---------|---------|
| 1. 环境准备 | 2小时 | 2小时 |
| 2. 登录页 | 1小时 | 3小时 |
| 3. 主布局 | 2小时 | 5小时 |
| 4. 数据看板 | 2小时 | 7小时 |
| 5. 申请审核 | 4小时 | 11小时 |
| 6. 排课管理 | 5小时 | 16小时 |
| 7. 排课结果 | 2小时 | 18小时 |
| 8. 云函数部署 | 1小时 | 19小时 |
| 9. 前端部署 | 0.5小时 | 19.5小时 |
| 10. 测试文档 | 1.5小时 | 21小时 |

**总计：** 约 21 小时（3个工作日）

---

## 优先级排序

### P0（核心功能，必须完成）
- 阶段 1: 环境准备
- 阶段 2: 登录页
- 阶段 3: 主布局
- 阶段 5: 申请审核
- 阶段 6: 排课管理

### P1（重要功能，建议完成）
- 阶段 4: 数据看板
- 阶段 7: 排课结果
- 阶段 8: 云函数部署
- 阶段 9: 前端部署

### P2（辅助功能，时间允许完成）
- 阶段 10: 测试文档

---

## 依赖关系

```
阶段1（环境准备）
  ↓
阶段2（登录页） + 阶段3（主布局）
  ↓
阶段4（数据看板） + 阶段5（申请审核） + 阶段6（排课管理） + 阶段7（排课结果）
  ↓（并行开发）
阶段8（云函数部署）
  ↓
阶段9（前端部署）
  ↓
阶段10（测试文档）
```

---

**文档版本：** v1.0  
**创建时间：** 2025-11-05  
**状态：** 待执行

